%new-style
%require-types
%strict-args
%enable-all-warnings

class TelcoCustomerAccountActivationSubworkflow inherits QorusSubworkflowArrayStep, DemoArrayBase {
    primary(auto arg) {
        # setup sensitive data for child order
        *hash<auto> sensitive_data;
        foreach hash<auto> i in (getSensitiveDataAliases().pairIterator()) {
            sensitive_data{i.value.skey}{i.value.svalue} = {
                "data": getSensitiveDataFromAlias(i.key).value,
                "aliases": i.key,
            };
        }
        bindSubworkflow({
            "name": "TELCO-ACTIVATE-ACCOUNT"
        }, {
            "staticdata": getStaticData().customer.accounts,
            "sensitive_data": sensitive_data,
            "orderkeys": {
                "customer_id": getOrderKeys().customer_id,
            },
        });
    }

    softlist<auto> array() {
        return DemoArrayBase::array();
    }
}
