# -*- mode: qore; indent-tabs-mode: nil -*-

# name: iot-stadium-floodlights-demo-erp-request
# version: 1.0
# desc: maps IoT stadium light change requests to order data
# type: Mapper
# author: Qore Technologies, s.r.o.
# parse-options: PO_NEW_STYLE
# define-group: iot-demo: IoT demo interfaces
# groups: iot-demo

OPTION: input: (
    "static": {
        "desc": "static data",
    },
    "context":  {
        "desc": "current execution context info",
    },
)

OPTION: output: (
    "name": {
        "type": "string",
        "desc": "request name",
    },
    "description": {
        "type": "string",
        "desc": "request description",
    },
    "effort": {
        "type": "int",
        "desc": "effort estimation",
    },
    "actionnum": {
        "type": "string",
        "desc": "the device ID for the request",
    },
    "status": {
        "type": "int",
        "desc": "status code",
    },
)

FIELD: name: {"constant": "order new bulb"}
FIELD: description: {
    "name": "static",
    "code": string sub (hash<auto> staticdata, hash<auto> rec) {
        return sprintf("Order new bulb for bulb to replace old with id=%y at stadium with id=%y",
            staticdata.input_data.device_id, staticdata.input_data.stadium_id);
    }
}
FIELD: effort: {"constant": 480}
FIELD: actionnum: {
    "name": "static",
    "code": auto sub (hash<auto> staticdata, hash<auto> rec) {
        return staticdata.input_data.device_id;
    }
}
FIELD: status: {"constant": 0}
# END
