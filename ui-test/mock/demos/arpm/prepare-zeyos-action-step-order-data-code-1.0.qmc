%new-style
%strict-args
%require-types
%enable-all-warnings

%requires json

class PrepareZeyosActionStepOrderDataCode {
    hash<auto> getStaticData(auto val, *hash<auto> rec) {
        hash<auto> ah = MapperApi::expandTemplatedValue("$transient:input");
        hash<auto> values = (map {$1.title: $1.taskState[0].value.toInt()}, ah.records) ?? {};
        return {
            "name": "PMA: " + ah.routeName,
            "description": make_json({
                "orig": ah,
                "values": values,
            }),
            "effort": int(ah.elapseTime),
            "actionnum": ah.routeName,
            "status": 1,
            "creator": "2",
        };
    }
}